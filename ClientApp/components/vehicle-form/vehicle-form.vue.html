<template>
    <div class="main">

        <div class="widget">
            <div class="title">Create Vehicle</div>
            <div class="chart">
                <div class="error-block error-bag" v-if="thereAreErrors">
                    <p>There are some errors! Please correct them and proceed.</p>
                </div>                
  
            <!-- <v-select v-model="selected" :options="features"></v-select> -->
           
                <form class="form-vetical form" @submit.prevent="validateBeforeSubmit()">
                    <div class="form-group">
                        <label for="make">Make</label>
                        <select v-validate="'required'" name="make" @change="changeVehicle" v-model="vehicleForm.makeId" id="make" class="form-control">                    
                            <option></option>
                            <option v-for="make in makes" :value="make.id">{{ make.name }}</option>
                        </select>

                        <i v-show="errors.has('make')" class="fa fa-warning"></i>
                        <span v-show="errors.has('make')" class="help is-danger">{{ errors.first('make') }}</span>
                    </div>

                    <div class="form-group" v-if="models.length">
                        <label for="models">Model</label>
                        <select v-validate="'required'" name="models" id="models" class="form-control" v-model="vehicleForm.modelId">   
                            <option></option>                         
                            <option v-for="model in models" :value="model.id">{{ model.name }}</option>
                        </select>
                        <i v-show="errors.has('models')" class="fa fa-warning"></i>
                        <span v-show="errors.has('models')" class="help is-danger">{{ errors.first('models') }}</span>
                    </div>

                    <div class="form-group">
                        <p>Is the vehicle registered?</p>
                    
                        <label for="isRegistered" class="radio-inline">
                            <input v-validate="'required'"
                            v-model="vehicleForm.isRegistered" 
                            value="true" id="isRegistered" type="radio" name="registered"> Yes
                        </label>
                        <label for="notRegistered" class="radio-inline">
                            <input v-model="vehicleForm.isRegistered" value="false" id="notRegistered" type="radio" name="registered"> No
                        </label><br/>

                        <i v-show="errors.has('registered')" class="fa fa-warning"></i>
                        <span v-show="errors.has('registered')" class="help is-danger">{{ errors.first('registered') }}</span>
                    </div>           
                

                    <h3>Feature</h3>
                    <div class="form-group">
                        <div class="checkbox" v-for="feature in features">
                            <label :for="'feature'+feature.id">
                                <input v-model="vehicleForm.features" :id="'feature'+feature.id" 
                                type="checkbox" :value="feature.id" 
                                class="checkbox"
                                name="features"
                                v-validate="'required'"                                                              
                                > {{ feature.name }}
                            </label>
                        </div>  
                        <i v-show="errors.has('features')" class="fa fa-warning"></i>
                        <span v-show="errors.has('features')" class="help is-danger">{{ errors.first('features') }}</span>
                    </div>

                    <h3>Contact</h3>
                    
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input v-model="vehicleForm.contact.name" 
                        type="text" id="name"
                        name="name"
                        v-validate="'required|:max:2'" 
                        :class="{'input': true, 'is-danger': errors.has('name') }"                       
                        class="form-control input-sm">

                        <i v-show="errors.has('name')" class="fa fa-warning"></i>
                        <span v-show="errors.has('name')" class="help is-danger">{{ errors.first('name') }}</span>
                        
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input v-model="vehicleForm.contact.email"
                        v-validate="'required|email'"   
                        name="email"                                            
                        type="text" id="email" class="form-control input-sm" 
                        :class="{'input': true, 'is-danger': errors.has('email') }">

                        <i v-show="errors.has('email')" class="fa fa-warning"></i>
                        <span v-show="errors.has('email')" class="help is-danger">{{ errors.first('email') }}</span>
                        
                    </div>

                <div class="form-group">
                    <label for="phone">Phone</label>
                    <input v-model="vehicleForm.contact.phone" type="text" id="phone" 
                    v-validate="'required|numeric|max:13'"
                    name="phone"
                    :class="{'input': true, 'is-danger': errors.has('phone')}"
                    class="form-control input-sm">

                    <i v-show="errors.has('phone')" class="fa fa-warning"></i>
                    <span v-show="errors.has('phone')" class="help is-danger">{{ errors.first('phone') }}</span>
                        
                </div>            

                <button class="btn btn-primary">Save</button>

                </form>
            </div>
        </div>

        <div class="widget">
            <div class="title">Test form</div>
            <div class="chart">
                {{ vehicleForm }}
            </div>
        </div> 


        <div v-if="features.length">
            
        </div>
        <p v-else>Loading data.....</p>

    </div>
</template>

<script src="./vehicle-form.ts"></script>